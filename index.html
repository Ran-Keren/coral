<!doctype html>
<html lang="he" dir="rtl">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
    <title>🧼 סבון טבעי מחלב אם: הזנה מהאם לתינוק</title>
    <style>
        :root{
            --gap:18px;
            --accent:#00695C; /* Dark Teal - for a natural/calm feel */
            --bg:#e0f7fa; /* Light Cyan Background */
            --text:#222;
            --success: #28a745;
            --error: #dc3545;
            --sidebar-width: 250px;
            --soft-white: #fefefe; 
        }
        html,body{
            height:100%;
            margin:0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans Hebrew', sans-serif;
            background: var(--bg);
            color:var(--text);
            overflow-x: hidden; 
        }
        /* FIXED: Adjusted padding-top now that logo is static */
        .app{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:24px;padding-top: 24px;box-sizing:border-box; flex-direction: column;}
        
        .card{
            width:100%;
            max-width:1100px;
            background:linear-gradient(180deg,var(--soft-white),#fbfbfb);
            border-radius:16px;
            box-shadow:0 12px 40px rgba(0,0,0,0.15);
            overflow:hidden;
            display:block; /* Changed from flex to block */
            /* Removed: gap:var(--gap); flex-direction:row-reverse; */
        }
        
        /* ADJUSTED: Content padding reset for desktop */
        .content{flex:1;min-width:260px;padding:28px;display:flex;flex-direction:column;gap:14px}
        
        /* Typography */
        h1{
            margin:0;
            font-size:26px; 
            color: var(--accent); 
            text-align: right; 
        }
        
        /* FIXED: Logo Style - Static positioning, centered block (non-floating) */
        .logo-header-wrapper {
            position: static; 
            margin: 0 auto 20px auto; /* Centering block and adding bottom margin */
            padding: 0; 
            z-index: 1; /* Lowered z-index */
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px; 
            background: none; 
            box-shadow: none; 
            /* Removed transition properties */
        }

        .logo-container { 
            /* Logo replacement styling - BIGGER */
            width: 200px; 
            height: 200px; 
            background-image: url('https://i.imgur.com/Df50Xpm.png'); 
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            /* Hide the 'K' text */
            text-indent: -9999px;
            display: inline-block;
            margin-left: 0;
        }
        
        /* REMOVED: Logo text styling is no longer needed */
        .logo-header-wrapper h1 { display: none; } 

        h2{font-size: 22px; color: var(--accent); border-bottom: 2px solid #eee; padding-bottom: 8px; margin-top: 25px; font-weight: 700;}
        /* Adjusted h3 style for product list for better readability */
        h3{font-size: 20px; color: #444; margin: 15px 0 5px;}
        .product-list h3 {
             color: var(--accent); /* Highlight product names */
             font-weight: 800; 
             margin-bottom: 5px;
             padding-bottom: 0;
             border-bottom: none;
        }

        p{margin:0;line-height:1.7}
        .lead{font-weight:600}
        
        /* Lists and Special Text */
        .natural-text { color: var(--accent); font-weight: 600; padding: 10px 0; border-right: 3px solid var(--accent); padding-right: 10px; }
        .feature-list { list-style: none; padding: 0; margin: 10px 0; }
        .feature-list li { margin-bottom: 8px; font-size: 16px; display: flex; align-items: center; }
        .feature-list li strong { font-weight: 700; color: #333; }
        .feature-icon { color: var(--accent); font-size: 20px; margin-left: 8px; line-height: 1; }
        
        /* CTA & Coupon Styles */
        .cta{margin-top:auto;display:flex;gap:10px;flex-wrap:wrap;align-items:center}
        .btn{background:var(--accent);color:#fff;border:none;padding:12px 18px;border-radius:10px;font-weight:700;cursor:pointer;transition:all 0.3s; text-align: center; box-shadow: 0 4px 10px rgba(0,105,92,0.2);}
        .btn:hover{background:#004d40;transform:translateY(-2px);box-shadow:0 6px 16px rgba(0,105,92,0.4)}
        .price{font-size:22px;font-weight:800;color:var(--accent)}
        
        /* Coupon Styles */
        .coupon-section {
            display: flex;
            gap: 5px;
            align-items: center; 
            margin-top: 10px;
            flex-direction: column; 
        }
        .coupon-input-group {
            display: flex;
            gap: 8px;
            align-items: center;
            width: 100%;
            justify-content: center;
        }
        .coupon-section input {
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 8px;
            width: 120px;
            font-size: 14px;
            text-align: center;
            direction: ltr; 
        }
        .btn-apply {
            background: var(--accent);
            border: 1px solid var(--accent);
            color: #fff;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 700;
            font-size: 14px;
            transition: all 0.2s;
        }

        .coupon-msg {
            font-size: 13px;
            font-weight: 700;
            min-height: 18px;
            text-align: center;
            margin-top: 2px;
        }
        .coupon-msg.success { color: var(--success); }
        .coupon-msg.error { color: var(--error); }

        /* --- Carousel Specific CSS (UPDATED FOR FULL WIDTH AND CONTAIN) --- */
        .carousel-wrap{
            width:100%; /* Take full width of the app container */
            max-width:1100px; /* Match max width of the card */
            min-width:0; /* Allow it to shrink */
            background: transparent; /* FIXED: Changed to transparent */
            border-radius:12px;
            overflow:hidden;
            position:relative;
            display:flex;
            align-items:center;
            justify-content:center;
            /* Center block horizontally */
            margin: 0 auto 15px auto; /* REDUCED SPACE (30px -> 15px) */
            /* Added fixed height for image uniformity */
            height: 400px; 
        }
        .slides-container {
            width: 100%;
            height: 100%; 
            overflow: hidden;
        }
        .slides {
            display: flex;
            transition: transform 0.5s ease-in-out;
            width: 300%; /* Total width for 3 slides */
            height: 100%; 
            direction: ltr; 
        }
        .slide {
            flex-shrink: 0;
            width: calc(100% / 3); /* Each slide takes up 1/3 of the 300% width */
            height: 100%;
            direction: rtl; 
        }
        .slide img{
            width:100%;
            height:100%;
            object-fit: contain; /* Remains 'contain' to avoid cropping */
            display:block
        }
        /* --- End Carousel Specific CSS --- */


        /* --- Compact Modal Styles --- */
        .modal{display:none;position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;background:rgba(0,0,0,0.6);align-items:center;justify-content:center; padding: 10px;}
        .modal.show{display:flex}
        
        .modal-content{
            background:var(--soft-white);
            padding: 20px 25px; 
            border-radius:18px;
            max-width:420px;
            width:100%;
            text-align:right;
            box-shadow:0 30px 80px rgba(0,0,0,0.4); 
            margin: auto; 
            border-top: 5px solid var(--accent);
            max-height: 95vh; 
            overflow-y: auto; 
            box-sizing: border-box;
        }

        .modal h2{margin:0 0 10px;color:var(--accent); text-align: center; font-size: 22px; border-bottom: none; padding-bottom: 0;}
        .modal h3{color:#333; margin-top: 0; font-size: 18px; text-align: center; padding: 5px 0;}
        .modal p{margin:5px 0;line-height:1.4}
        .modal-buttons{display:flex;gap:10px;margin-top:15px;justify-content:center; flex-wrap: wrap;}
        
        /* Compact Form Elements */
        select{width:100%;padding:8px;border-radius:8px;border:1px solid #ddd;font-size:16px;text-align:right;cursor:pointer; background-color: #f9f9f9;}
        
        .form-group{margin-bottom: 10px; text-align: right;} 
        .form-group label{display: block; margin-bottom: 2px; font-weight: 600; color: #333; font-size: 14px;}
        .form-group input, .form-group textarea{width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; font-size: 16px; background-color: #f9f9f9; min-height: 38px;}
        .form-group textarea { resize: vertical; min-height: 60px; }
        
        .price-container {
            text-align: center;
            padding: 5px;
            margin-top: 5px !important;
        }
        .old-price {
            text-decoration: line-through;
            color: #999;
            font-size: 14px;
            margin-left: 10px;
            display: none;
        }
        .old-price.show { display: inline-block; }

        /* Payment Modal Specific Styling */
        #paymentModalTitle {
            font-size: 24px;
            font-weight: 800;
            margin-bottom: 5px;
        }
        #paymentModal .modal-content {
            background: linear-gradient(135deg, var(--soft-white), #f0fff0); 
            max-width: 380px;
            padding: 25px;
            text-align: center; 
        }
        #paymentModal p {
            text-align: center;
            font-size: 15px;
            color: #555;
            margin: 10px 0;
        }
        #paymentModal p strong {
            display: block;
            font-size: 24px;
            color: var(--accent);
            margin-top: 5px;
        }
        #paymentTotalAmount {
            font-size: 28px !important;
            font-weight: 800;
            color: #E91E63; 
            display: inline;
            direction: ltr;
        }
        #openBitApp {
            background-color: #4CAF50; 
            transition: all 0.3s;
            padding: 12px 20px;
            font-size: 18px;
            margin-top: 10px;
        }
        #openBitApp:hover {
            background-color: #388E3C;
        }

        /* NEW: Flex group for total and copies */
        .total-copies-group {
             display: flex;
             justify-content: space-around;
             align-items: center;
             gap: 15px;
        }
        .total-copies-group .form-group {
             flex: 1;
             margin-bottom: 0;
        }
        .total-copies-group .price-display {
             flex-shrink: 0;
             text-align: center;
        }
        /* Mobile adjustment for copies select width */
        #productSelectionModal #copies {
            width: 100%;
        }

        /* --- Sidebar Styles (UPDATED TO FLOATING/FIXED TOGGLE) --- */
        #sidebar-toggle {
            /* FIXED: Floating Styles */
            position: fixed; 
            top: 20px;
            right: 20px; /* FIXED: Positioned to the right */
            left: auto; /* Ensure left is not set */
            
            background: var(--accent);
            color: #fff;
            border: none;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            z-index: 100; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        .sidebar {
            position: fixed;
            top: 0;
            right: -270px; 
            width: var(--sidebar-width);
            height: 100%;
            background: var(--soft-white);
            box-shadow: none;
            transition: right 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
            z-index: 150; 
            padding: 25px 20px;
            box-sizing: border-box;
            overflow-y: auto;
            text-align: right;
        }
        .sidebar.open {
            right: 0; 
            box-shadow: -4px 0 15px rgba(0,0,0,0.15); 
        }
        .close-sidebar {
            background: none;
            border: none;
            font-size: 35px;
            position: absolute;
            left: 10px;
            top: 5px;
            cursor: pointer;
            color: var(--accent);
            line-height: 1;
            font-weight: 300;
        }
        .sidebar h3 {
            color: var(--accent);
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
            margin-top: 0;
        }
        .sidebar ul {
            list-style: none;
            padding: 0;
        }
        .sidebar li {
            margin-bottom: 10px;
        }
        .sidebar a {
            color: var(--text);
            text-decoration: none;
            display: block;
            padding: 8px 0;
            transition: color 0.2s;
            font-weight: 500;
        }
        .sidebar a:hover {
            color: #00897B; 
            padding-right: 5px;
        }
        
        /* Overlay for Sidebar */
        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 120; 
            cursor: pointer;
        }
        .overlay.show {
            display: block;
        }

        /* Responsive */
        @media (max-width:900px){
            .card{
                /* No longer a flex row layout for two main elements */
                display: block;
            }
            /* Increased height for mobile */
            .carousel-wrap{
                /* Now full width, no need for min/max width overrides */
                width:100%;
                max-width:1100px;
                min-width:0;
                height:350px;
                margin-bottom: 10px; /* REDUCED SPACE (20px -> 10px) */
            }
            /* ADJUSTED: Content padding reset for mobile */
            .content{padding:18px;}
            
            .logo-header-wrapper {
                 /* Removed top: 5px; */
                 margin-bottom: 15px;
            }
            .logo-container { 
                width: 120px; /* ADJUSTED: Smaller for tablet/mobile */
                height: 120px;
            }
            
            /* ADJUSTED: Sidebar toggle position (fixed but adjusted for mobile view) */
            #sidebar-toggle {
                right: 15px; /* FIXED: Adjusting fixed position for mobile */
                left: auto; /* Ensure left is auto */
                top: 15px;
                margin: 0;
                padding: 8px 12px;
                font-size: 14px;
                z-index: 1000;
            }
            
            /* Padding for app on small screens so the logo doesn't cover the main content */
            .app {
                padding-top: 24px; /* No need for large padding-top anymore */
            }
            
            /* Modal adjustments for smaller devices */
            .modal-content {
                padding: 15px;
                width: 95%; /* Ensures it doesn't touch edges */
            }
            .form-group { margin-bottom: 8px; }
            .modal h2 { font-size: 20px; margin-bottom: 5px; }
            hr { margin: 10px 0 !important; }
        }
        
        /* Mobile Specific (further refinements) */
        @media (max-width: 550px) {
            
            .logo-container { 
                width: 100px; /* ADJUSTED: Smaller for very small screens */
                height: 100px;
            }
            
            #sidebar-toggle {
                padding: 8px 12px;
                font-size: 14px;
            }
            .sidebar {
                --sidebar-width: 220px; 
                right: -240px; 
            }
            .sidebar.open {
                right: 0; 
            }
            
            .app {
                padding-top: 24px; /* No need for large padding-top anymore */
            }
        }

    </style>
</head>
<body>
    <div class="overlay" id="sidebar-overlay"></div>
    <div class="sidebar" id="sidebar">
        <button class="close-sidebar" id="close-sidebar-btn">×</button> 
        <h3>תוכן עניינים ✨</h3>
        <ul>
            <li><a href="#product-description">אודות המוצר</a></li>
            <li><a href="#benefits">יתרונות הסבון</a></li>
            <li><a href="#about-coral">הסיפור שלנו</a></li>
            <li><a href="#product-variations">🌱 המוצרים שלנו</a></li>
            <li><a href="#order-form">הזמנה ותשלום</a></li>
        </ul>
        <p style="margin-top: 30px; font-size: 14px; color: #666;">
            לכל שאלה נוספת, ניתן ליצור קשר.
            <br>
            **קורל: 050-8463242**
        </p>
    </div>

    <div class="app">
        
        <div class="logo-header-wrapper">
            <span class="logo-container">K</span> 
        </div>
        
        <button id="sidebar-toggle">תפריט ☰</button>
        
        <div class="carousel-wrap" aria-roledescription="carousel">
            <div class="slides-container">
                <div class="slides" id="slides">
                    <div class="slide"><img alt="סבון מחלב אם טבעי - תמונה 1" src="https://i.imgur.com/m2nDchP.jpeg"/></div>
                    <div class="slide"><img alt="סבון מחלב אם טבעי - תמונה 2" src="https://i.imgur.com/E1cDUXD.jpeg"/></div>
                    <div class="slide"><img alt="סבון מחלב אם טבעי - תמונה 3" src="https://i.imgur.com/xGCiRsO.jpeg"/></div>
                </div>
            </div>
        </div>
        <div class="card" role="application">
            
            <div class="content">

                <h1>סבון טבעי מחלב אם</h1>
                <p class="lead" style="color: #444; font-size: 18px; text-align: center;">
                    **טבעי. אישי. מושלם**
                </p>

                <p class="lead" id="product-description">
                    העניקי לתינוקך מתנה מפנקת ומזינה – אל-סבון ייחודי וטבעי העשוי **מחלב האם שלך**. הזנה ישירה דרך העור.
                </p>

                <div class="natural-text">
                    הסבון משלב את חלב האם עם **שמנים טבעיים נוספים**, ונועד להקל על תסמיני יובש, גירוי, אדמומיות ותסמיני אסתמה של העור. 
                </div>

                <h2 id="benefits">🌿 יתרונות הסבון הטבעי</h2>
                <ul class="feature-list">
                    <li><span class="feature-icon">✔️</span> **מגיל לידה:** מתאים לעור הרגיש ביותר.</li>
                    <li><span class="feature-icon">✨</span> **הקלה מיידית:** מתאים לעור רגיש ולתינוקות שסובלים מ"קליפה" (קשקשת) בראש.</li>
                    <li><span class="feature-icon">🌱</span> **רכיבים טבעיים בלבד:** ללא SLS, פראבנים, חומרי ריח סינטטיים או כימיקלים קשים.</li>
                    <li><span class="feature-icon">👐</span> **ייצור בשיטה קרה:** מיוצר בעבודת יד, תוך שמירה מקסימלית על הרכיבים הפעילים והמינרלים שבחלב האם.</li>
                </ul>

                <h2 id="about-coral">💖 קצת עליי ועל סגולות חלב האם</h2>
                <p>
                    נעים להכיר, שמי קורל, עורכת-דין ואימא לשני בנים מקסימים. הרעיון לייצר אל-סבון מחלב אם נולד מתוך **ניסיוני האישי** עם בני הבכור שסבל מתסמינים קשים של אסתמה של העור.
                </p>
                <p>
                    לאחר שניסיתי אינספור תכשירים יקרים ללא הצלחה, נחשפתי לסגולות האדירות של חלב אם כתרכובת מזינה, מלאת לחות ונוגדנים. מאז שהתחלתי לרקוח סבוני חלב אם, עורו של בני השתפר פלאים. הרגשתי שאני **חייבת לחלוק את הפלא הזה גם עם אימהות אחרות**.
                </p>
                
                <h2 id="product-variations">🌱 המוצרים שלנו:</h2>
                
                <p style="font-size: 16px; font-weight: 600; color: var(--accent); margin-bottom: 15px; border-right: 3px solid var(--accent); padding-right: 10px;">
                    ניתן לבקש מתכון מותאם אישית, לפי הנתונים האישיים של עור התינוק שלך.
                </p>

                <div class="product-list" style="display: flex; flex-direction: column; gap: 20px;">
                    
                    <div class="product-item">
                        <h3>1. מגע מזין</h3>
                        <p style="font-weight: 600;">תכשיר לחות שמעניק לחות עמוקה לעור יבש, כמו חיבוק מחמם של אימא.</p>
                        <p style="font-size: 14px; color: #555;">אל-סבון גוף עדין ומעורר לחות לעור יבש. מכיל חמאת שיאה ושמן שקדים.</p>
                    </div>

                    <div class="product-item">
                        <h3>2. מגע מתוק</h3>
                        <p style="font-weight: 600;">תכשיר לחות מפנק עם ריח טבעי עדין, כמו נשיקה אוהבת של אימא.</p>
                        <p style="font-size: 14px; color: #555;">אל-סבון מפנק עם ריח טבעי עדין של קקאו. מכיל חמאת קקאו ושמן זית.</p>
                    </div>

                    <div class="product-item">
                        <h3>3. מגע טהור</h3>
                        <p style="font-weight: 600;">תכשיר לחות עדין לניקוי עור רגיש, כמו מגע נקי וטהור של אימא.</p>
                        <p style="font-size: 14px; color: #555;">אל-סבון פנים עדין לניקוי עור רגיש. מכיל חימר לבן ושמן חוחובה.</p>
                    </div>

                    <div class="product-item">
                        <h3>4. מגע פורח</h3>
                        <p style="font-weight: 600;">תכשיר לחות מרגיע לעור אדמומי, כמו ליטוף אימהי עדין.</p>
                        <p style="font-size: 14px; color: #555;">אל-סבון גוף מרגיע לעור אדמומי או מגורה. מכיל שמן קלנדולה אורגני ושיבולת שועל.</p>
                    </div>

                    <div class="product-item">
                        <h3>5. מגע אוהב</h3>
                        <p style="font-weight: 600;">תכשיר לחות עדין לניקוי עור ושיער, כמו אהבת אם שאינה נגמרת.</p>
                        <p style="font-size: 14px; color: #555;">אל-סבון עדין לניקוי השיער והקרקפת. מכיל שמן קיק ושמן זרעי ענבים.</p>
                    </div>

                    <div class="product-item">
                        <h3>6. מגע חמים</h3>
                        <p style="font-weight: 600;">תכשיר לחות מזין לעור יבש, כמו תחושת חמימות של בית ואימא.</p>
                        <p style="font-size: 14px; color: #555;">אל-סבון מזין לעור יבש במיוחד. מכיל שמן שומשום.</p>
                    </div>
                    
                    <div class="product-item">
                        <h3>7. מגע מגונן</h3>
                        <p style="font-weight: 600;">תכשיר לחות לעור רגיש ועדין, כמו יד אימהית מגוננת.</p>
                        <p style="font-size: 14px; color: #555;">אל-סבון טיפולי לעור רגיש, מתאים במיוחד לתינוקות עם נטייה לאדמומיות. מכיל שמן אובליפיחה אורגני.</p>
                    </div>

                </div>

                <h3 style="margin-top: 30px; border-bottom: 2px solid #eee; padding-bottom: 5px; color: var(--accent);">⚠️ הנחיות כלליות</h3>
                
                <p style="font-size: 14px; color: #555; margin-bottom: 5px;">
                    **איך זה עובד?** ניתן להביא את חלב האם האישי שלך למספר נקודות איסוף, או להשתמש בחלב אם של תורמת. כמות החלב הדרושה היא **40 מ"ל ליחידה**. 
                </p>
                
                <ul style="list-style-type: '• '; padding-right: 20px; font-size: 14px; color: #555; margin-top: 10px;">
                    <li>הסבון אינו תרופה ואינו ראוי למאכל.</li>
                    <li>אין לבלוע, יש להפסיק את השימוש במקרה של גירוי.</li>
                    <li>היות שמדובר באל-סבון עבודת יד, הרי שהגודל, הצבע, המרקם והמשקל עשויים להשתנות.</li>
                    <li style="font-weight: 700; color: var(--error);">**תוקף הסבון: חודשיים. יש לשמור בקירור.**</li>
                </ul>

                <h2 id="order-form">🎁 הזמנה ותשלום</h2>
                
                <div class="cta" style="margin-top: 30px;">
                    <button class="btn" id="openOrderModalBtn" style="width: 100%;">להזמנה ולמעבר לתשלום 🛒</button>
                </div>
                
            </div>
            
            </div>
    </div>

    <div class="modal" id="productSelectionModal">
        <div class="modal-content">
            <h2>שלב 1: בחירת מוצר ועיצוב 🧼</h2>
            
            <div class="form-group">
                <label for="copies">כמות סבונים:</label>
                <select id="copies">
                    <option value="1">1 יח' (₪45)</option>
                    <option value="2">2 יח' (₪90)</option>
                    <option value="4">4 יח' (₪180)</option>
                    <option value="6">6 יח' (₪270)</option>
                    <option value="10">10 יח' (₪450)</option>
                </select>
            </div>

            <div class="form-group">
                <label for="recipe">שם המתכון / מגע:</label>
                <select id="recipe" required>
                    <option value="" disabled selected>בחר מתכון (מגע מזין, מתוק, טהור...)</option>
                    <option value="מגע מזין">מגע מזין</option>
                    <option value="מגע מתוק">מגע מתוק</option>
                    <option value="מגע טהור">מגע טהור</option>
                    <option value="מגע פורח">מגע פורח</option>
                    <option value="מגע אוהב">מגע אוהב</option>
                    <option value="מגע חמים">מגע חמים</option>
                    <option value="מגע מגונן">מגע מגונן</option>
                </select>
            </div>

            <div class="form-group">
                <label for="shape">צורה:</label>
                <select id="shape" required>
                    <option value="" disabled selected>בחר צורה</option>
                    <option value="מלבנית">מלבנית</option>
                    <option value="שושנה">שושנה</option>
                    <option value="לב (2 יח' במארז)">לב (2 יח' במארז)</option>
                </select>
            </div>

            <div class="form-group">
                <label for="essentialOil">שמן אתרי:</label>
                <select id="essentialOil">
                    <option value="ללא">ללא</option>
                    <option value="לבנדר">לבנדר</option>
                    <option value="קמומיל">קמומיל</option>
                    <option value="עץ התה">עץ התה</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="blessing">הוספת ברכה (טקסט עד 50 אותיות - אופציונלי):</label>
                <textarea id="blessing" maxlength="50" placeholder="לדוגמה: לילד המתוק שלנו, באהבה גדולה."></textarea>
            </div>
            
            <div class="price-container">
                <div class="price" id="totalPrice" style="font-size: 24px;">₪45</div>
                <span class="old-price" id="oldPrice"></span>
            </div>

            <div class="coupon-section">
                <div class="coupon-input-group">
                    <input type="text" id="couponCode" placeholder="קוד קופון">
                    <button type="button" class="btn-apply" id="applyCouponBtn">החל</button>
                </div>
                <div class="coupon-msg" id="couponMsg"></div>
            </div>

            <div class="modal-buttons">
                <button class="btn" id="continueToShippingBtn" style="flex-grow: 1;">המשך לפרטי משלוח</button>
                <button class="btn close-modal" data-modal="productSelectionModal" style="background: #999; flex-grow: 1;">ביטול</button>
            </div>
        </div>
    </div>
    
    <div class="modal" id="shippingDetailsModal">
        <div class="modal-content">
            <h2>שלב 2: פרטי משלוח והתאמה 🚚</h2>
            
            <h3>פרטי משלוח</h3>
            <div class="form-group"><label for="shippingName">שם מלא</label><input type="text" id="shippingName" required placeholder="שם ושם משפחה"></div>
            <div class="form-group"><label for="shippingPhone">טלפון</label><input type="tel" id="shippingPhone" required placeholder="05X-XXXXXXX"></div>
            <div class="form-group"><label for="shippingEmail">דוא"ל</label><input type="email" id="shippingEmail" required placeholder="example@mail.com"></div>
            <div class="form-group"><label for="shippingCity">עיר</label><input type="text" id="shippingCity" required placeholder="לדוגמה: תל אביב"></div>
            <div class="form-group"><label for="shippingAddress">כתובת</label><input type="text" id="shippingAddress" required placeholder="רחוב, מספר בית, דירה"></div>
            
            <hr style="border: 0; border-top: 1px dashed #eee; margin: 10px 0;">

            <h3>פרטי התאמה אישית</h3>
            <div class="form-group"><label for="babyAge">גיל התינוק (חודשים)</label><input type="number" id="babyAge" required placeholder="לדוגמה: 3" min="0" max="48"></div>
            <div class="form-group"><label for="allergies">אלרגיות / הערות נוספות (אופציונלי)</label><textarea id="allergies" placeholder="ציין אלרגיות ידועות או בקשות נוספות"></textarea></div>

            <div class="modal-buttons">
                <button class="btn" id="backToProductsBtn" style="background: #999; flex-grow: 1;">חזרה לבחירת מוצר</button>
                <button class="btn" id="continueToPaymentBtn" style="flex-grow: 1;">המשך לתשלום</button>
            </div>
        </div>
    </div>
    
    <div class="modal" id="paymentModal">
        <div class="modal-content">
            <h2 id="paymentModalTitle">שלב התשלום ✅</h2>
            <p>
                **סכום סופי לתשלום: <span id="paymentTotalAmount">₪45</span>**
            </p>
            <hr style="border: 0; border-top: 1px solid #ddd; margin: 15px 0;">
            <p style="font-size: 14px;">
                לחיצה על הכפתור תשלח אלינו את פרטי ההזמנה שלך ותעביר אותך לתשלום מאובטח באמצעות אפליקציית Bit.
            </p>
            <div class="modal-buttons" style="flex-direction: column; width: 100%;">
                <button class="btn" id="openBitApp" style="width: 100%;">מעבר לתשלום (Bit)</button>
                <button class="btn close-modal" data-modal="paymentModal" style="background: #999; width: 100%; margin-top: 5px;">ביטול וחזרה</button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
    
    <script>
        // Initialize EmailJS (REPLACE WITH YOUR KEYS)
        // **IMPORTANT:** Replace 'service_cprtttd' and 'template_m39ushb' with your actual service/template IDs
        emailjs.init('ecHybfD_vT68aQGnO'); 

        const PRICE_PER_SOAP = 45; 
        
        const COUPONS = {
            'TALYA20': 0.20, // 20% discount
            'MAMA10': 0.10,  // 10% discount
            'YOLADET': 0.15 // 15% discount
        };
        let isDiscountApplied = false;
        let discountRate = 0; 

        // Elements
        const copiesInput = document.getElementById('copies');
        const totalPriceEl = document.getElementById('totalPrice');
        const oldPriceEl = document.getElementById('oldPrice'); 
        
        const openOrderModalBtn = document.getElementById('openOrderModalBtn'); 

        // Step 1 Modals
        const productSelectionModal = document.getElementById('productSelectionModal');
        const continueToShippingBtn = document.getElementById('continueToShippingBtn');
        
        // Step 2 Modals
        const shippingDetailsModal = document.getElementById('shippingDetailsModal');
        const backToProductsBtn = document.getElementById('backToProductsBtn');
        const continueToPaymentBtn = document.getElementById('continueToPaymentBtn');
        
        // Step 3 Modals
        const paymentModal = document.getElementById('paymentModal');
        const paymentTotalAmount = document.getElementById('paymentTotalAmount');
        const openBitApp = document.getElementById('openBitApp'); 

        const couponInput = document.getElementById('couponCode');
        const applyCouponBtn = document.getElementById('applyCouponBtn');
        const couponMsg = document.getElementById('couponMsg');

        // NEW ORDER FIELDS
        const recipeInput = document.getElementById('recipe');
        const shapeInput = document.getElementById('shape');
        const essentialOilInput = document.getElementById('essentialOil');
        const blessingInput = document.getElementById('blessing');
        
        // SHIPPING FIELDS
        const shippingName = document.getElementById('shippingName');
        const shippingPhone = document.getElementById('shippingPhone');
        const shippingEmail = document.getElementById('shippingEmail');
        const shippingCity = document.getElementById('shippingCity');
        const shippingAddress = document.getElementById('shippingAddress');
        const babyAge = document.getElementById('babyAge');
        const allergies = document.getElementById('allergies');


        // Sidebar Elements (unchanged)
        const sidebar = document.getElementById('sidebar');
        const sidebarToggle = document.getElementById('sidebar-toggle');
        const closeSidebarBtn = document.getElementById('close-sidebar-btn');
        const sidebarOverlay = document.getElementById('sidebar-overlay');

        let currentOrderData = {};

        function updateTotal() {
            const quantity = parseInt(copiesInput.value) || 1;
            let total = PRICE_PER_SOAP * quantity;
            let finalTotal = total;
            
            if (isDiscountApplied) {
                finalTotal = total * (1 - discountRate);
                finalTotal = Math.round(finalTotal); // Round to nearest Shekel
                
                oldPriceEl.textContent = `₪${total}`;
                oldPriceEl.classList.add('show');
            } else {
                oldPriceEl.classList.remove('show');
            }

            totalPriceEl.textContent = `₪${finalTotal}`;
            paymentTotalAmount.textContent = `₪${finalTotal}`; 
        }

        function applyCoupon() {
            const inputCode = couponInput.value.trim().toUpperCase();
            
            if (COUPONS.hasOwnProperty(inputCode)) {
                if (!isDiscountApplied) {
                    isDiscountApplied = true;
                    discountRate = COUPONS[inputCode]; 
                    const discountPercent = discountRate * 100;

                    couponMsg.textContent = `הקופון הופעל! (${discountPercent}% הנחה)`;
                    couponMsg.className = "coupon-msg success";
                    
                    couponInput.disabled = true; 
                    applyCouponBtn.disabled = true;
                    applyCouponBtn.textContent = "V";
                    updateTotal();
                }
            } else if (inputCode === "") {
                couponMsg.textContent = "הזן קוד";
                couponMsg.className = "coupon-msg error";
            } else {
                couponMsg.textContent = "קוד שגוי";
                couponMsg.className = "coupon-msg error";
            }
        }


        function closeModal(modalElement) {
            modalElement.classList.remove('show');
        }

        // --- Sidebar Logic ---
        function toggleSidebar() {
            sidebar.classList.toggle('open');
            sidebarOverlay.classList.toggle('show');
        }

        sidebarToggle.addEventListener('click', toggleSidebar);
        closeSidebarBtn.addEventListener('click', toggleSidebar);
        sidebarOverlay.addEventListener('click', toggleSidebar);
        
        document.querySelectorAll('.sidebar a').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const targetId = link.getAttribute('href');
                const targetElement = document.querySelector(targetId);
                if (targetElement) {
                    targetElement.scrollIntoView({ behavior: 'smooth' });
                    // Close sidebar after click
                    if (sidebar.classList.contains('open')) {
                         toggleSidebar();
                    }
                }
            });
        });

        // --- Email Sending Logic ---
        function sendOrderEmail() {
            if (Object.keys(currentOrderData).length === 0) {
                return;
            }
            
            // Format the product details nicely
            const productDetails = `
                כמות: ${currentOrderData.copies} יח'
                מתכון: ${currentOrderData.recipe}
                צורה: ${currentOrderData.shape}
                שמן אתרי: ${currentOrderData.essentialOil}
                ברכה: ${currentOrderData.blessing || 'ללא'}
                גיל התינוק: ${currentOrderData.babyAge} חודשים
                אלרגיות/הערות: ${currentOrderData.allergies || 'ללא'}
            `.trim();


            emailjs.send('service_cprtttd', 'template_m39ushb', {
                to_email: 'c203240130@gmail.com', // **REPLACE WITH THE REAL EMAIL**
                name: currentOrderData.name,
                phone: currentOrderData.phone,
                email: currentOrderData.email,
                city: currentOrderData.city,
                address: currentOrderData.address,
                product_details: productDetails, // Pass the formatted product details
                total: currentOrderData.totalPrice,
                product_name: "סבון טבעי מחלב אם" 
            })
            .then(function(response) {
                console.log('Order Email Sent SUCCESSFULLY');
            }, function(error) {
                console.warn('Order Email FAILED to send', error);
            });
        }
        // --- End Email Sending Logic ---


        openOrderModalBtn.addEventListener('click', ()=>{ 
            updateTotal();
            productSelectionModal.classList.add('show'); 
        });

        copiesInput.addEventListener('change', updateTotal);
        applyCouponBtn.addEventListener('click', applyCoupon);
        couponInput.addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                e.preventDefault(); 
                applyCoupon();
            }
        });
        
        updateTotal(); 


        // --- CAROUSEL LOGIC (RTL FIXED) ---
        (function(){
            const slidesEl = document.getElementById('slides');
            const slides = Array.from(slidesEl.children);
            if (slides.length <= 1) return;
            let index = 0;
            const intervalMs = 3000; // Time per slide
            let timer = null;
            
            function update(){
                // Calculate the translation distance: index * (100% / number of slides)
                const slideWidth = 100 / slides.length; 
                
                // For RTL display, we use a POSITIVE translateX value
                slidesEl.style.transform = `translateX(${index * slideWidth}%)`;
            }

            function nextSlide(){ 
                index = (index + 1) % slides.length; 
                update(); 
            }
            
            function startTimer(){ 
                if(timer) clearInterval(timer); 
                timer = setInterval(nextSlide, intervalMs); 
            }
            
            startTimer();

            // Pause timer on hover
            const carouselWrap = document.querySelector('.carousel-wrap');
            carouselWrap.addEventListener('mouseenter', ()=>{ if(timer) clearInterval(timer); });
            carouselWrap.addEventListener('mouseleave', ()=>{ startTimer(); });

            update();
        })();
        // --- END CAROUSEL LOGIC ---

        // --- Step 1 to Step 2 Transition ---
        continueToShippingBtn.addEventListener('click', ()=>{
            const recipe = recipeInput.value;
            const shape = shapeInput.value;
            const copies = parseInt(copiesInput.value);
            
            if (!recipe) {
                alert('אנא בחרו מתכון/מגע.');
                return;
            }
            if (!shape) {
                alert('אנא בחרו צורה רצויה.');
                return;
            }
            
            // --- UPDATED VALIDATION LOGIC ---
            // Only check for odd numbers if the shape is exactly 'לב (2 יח' במארז)'
            const heartShapeValue = 'לב (2 יח\' במארז)';
            if (shape === heartShapeValue && (copies % 2 !== 0)) {
                 alert('שימו לב: צורת "לב" מגיעה 2 יח\' במארז. אנא בחרו כמות זוגית.');
                 return;
            }
            
            // Collect Product Data
            currentOrderData.copies = copiesInput.value;
            currentOrderData.totalPrice = paymentTotalAmount.textContent;
            currentOrderData.recipe = recipe;
            currentOrderData.shape = shape;
            currentOrderData.essentialOil = essentialOilInput.value;
            currentOrderData.blessing = blessingInput.value.trim();

            closeModal(productSelectionModal);
            shippingDetailsModal.classList.add('show');
        });

        // --- Step 2 Back to Step 1 ---
        backToProductsBtn.addEventListener('click', ()=>{
            closeModal(shippingDetailsModal);
            productSelectionModal.classList.add('show');
        });
        
        // --- Step 2 to Step 3 Transition ---
        continueToPaymentBtn.addEventListener('click', (e)=>{
            const name = shippingName.value.trim();
            const phone = shippingPhone.value.trim();
            const email = shippingEmail.value.trim();
            const city = shippingCity.value.trim();
            const address = shippingAddress.value.trim();
            const age = babyAge.value.trim();
            const notes = allergies.value.trim();
            
            if (!name || !phone || !email || !city || !address || !age) {
                alert('אנא מלאו את כל פרטי המשלוח וההתאמה האישית (כולל גיל התינוק).');
                return;
            }
            
            // Collect Shipping Data
            currentOrderData.name = name;
            currentOrderData.phone = phone;
            currentOrderData.email = email;
            currentOrderData.city = city;
            currentOrderData.address = address;
            currentOrderData.babyAge = age;
            currentOrderData.allergies = notes;

            closeModal(shippingDetailsModal);
            paymentModal.classList.add('show');
        });

        openBitApp.addEventListener('click', ()=>{
            sendOrderEmail(); // Send the order details via email
            
            // Redirect to BitPay link (Placeholder - replace with Coral's link if needed)
            window.open('https://www.bitpay.co.il/app/me/9364874B-AF78-48EC-1189-1141F63194B7269A', '_blank');

            // Close the modal after submission
            closeModal(paymentModal);
        });

        document.querySelectorAll('.close-modal').forEach(button => {
            button.addEventListener('click', () => {
                const modalId = button.dataset.modal || (button.closest('.modal') ? button.closest('.modal').id : null);
                if (modalId === 'paymentModal') {
                    // Back to shipping form from payment
                    closeModal(document.getElementById(modalId));
                    shippingDetailsModal.classList.add('show'); // Go back to step 2
                } else if (modalId) {
                    closeModal(document.getElementById(modalId));
                }
            });
        });

        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', (e) => {
                if (e.target.classList.contains('modal')) {
                    closeModal(modal);
                }
            });
        });

    </script>
</body>
</html>
